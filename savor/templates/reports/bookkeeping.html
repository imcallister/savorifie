{% extends base_template %}
{% load staticfiles %}
{% load render_bundle from webpack_loader %}
{% load humanize %}


{% block extrahead %}
<link rel="stylesheet" href="{{STATIC_URL}}base/css/fixed-data-table.min.css">
<link rel="stylesheet" href="{{STATIC_URL}}base/css/react-bootstrap-table-all.min.css">

<!--
<style>
    .modal.modal-wide .modal-dialog {
      width: 90%;
    }
    .modal-wide .modal-body {
      overflow-y: auto;
    }

    /* irrelevant styling */
    body p { 
      max-width: 400px; 
      margin: 20px auto; 
    }
    #tallModal .modal-body p { margin-bottom: 900px };

</style>
-->

{% endblock %}


{% block breadcrumb %}
<li class="active">Home</li>

{{ block.super }}
{% endblock %}


{% block content %}

<div class="container-fluid" id="wrapper">
    <div class="row">
        <div class="col-md-4">  
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">File Uploads</h3>
                </div>
                <div class="panel-body">
                    <div>
                        <div class="row">
                            <div>
                                <table class="table table-striped table-condensed">
                                    <thead>
                                        <th></th>
                                        <th style = "text-align: right;">Loaded Thru</th>
                                    </thead>
                                    <tbody>
                                        {% for row in upload_rows %}
                                            <tr>
                                                <td>{{row.0}}</td>
                                                <td align="right">
                                                    {{row.1}}</a>
                                                </td>
                                            </tr>    
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">    
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Uploads</h3>
                </div>
                <div class="panel-body">
                    <div>
                        <ul class="nav nav-pills nav-stacked">
                            <li><a class="btn btn-warning" data-toggle="modal" data-target="#FRBuploader">Load First Republic</a></li>
                            <li><a class="btn btn-warning" data-toggle="modal" data-target="#loadMasterCard">Load Mastercard</a></li>
                            <li><a class="btn btn-warning" data-toggle="modal" data-target="#loadUPS">Load UPS</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">    
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Shipping Charge Reports</h3>
                </div>
                <div class="panel-body">
                    <div>
                        <ul class="nav nav-pills nav-stacked">
                            <li><a class="btn btn-info" data-toggle="modal" data-target="#upsInvoices">UPS Invoices</a></li>
                            <li><a class="btn btn-info" data-toggle="modal" data-target="#misUPS">UPS Mis-Billed</a></li>
                            <li><a class="btn btn-info" data-toggle="modal" data-target="#noShipcharge">Fulfills with no Shipping Charge</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
    </div>


    <div class="row">
        <div class="col-md-8">    
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Expenses</h3>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="panel panel-danger">
                                <div class="panel-heading text-center">
                                    <h3 class="panel-title">INCOMPLETE</br>EXPENSES</h3>
                                </div>
                                <div class="panel-body text-center">
                                    <font size="20"><a href='/admin/base/expense/?unmatched=UNMATCHED'>{{incomplete_expenses}}</a></font>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="panel panel-warning">
                                <div class="panel-heading text-center">
                                    <h3 class="panel-title">INCOMPLETE</br>BANKING ENTRIES</h3>
                                </div>
                                <div class="panel-body text-center">
                                    <font size="20"><a href='/admin/base/cashflow/?unmatched=UNMATCHED'>{{incomplete_banking}}</a></font>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="panel panel-warning">
                                <div class="panel-heading text-center">
                                    <h3 class="panel-title">INCOMPLETE</br>CREDIT CARD ENTRIES</h3>
                                </div>
                                <div class="panel-body text-center">
                                    <font size="20"><a href='/admin/base/creditcardtrans/?unmatched=UNMATCHED'>{{incomplete_mcard}}</a></font>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">    
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Shopify Receivables Reports</h3>
                </div>
                <div class="panel-body">
                    <div>
                        <ul class="nav nav-pills nav-stacked">
                            <li>
                                <a class="btn btn-info" data-toggle="modal" data-target="#shopifyUnpaid">
                                    View Unpaid Shopify
                                </a>
                            </li>
                            <li><a class="btn btn-info" data-toggle="modal" data-target="#shopifyComp">View Shopify Payouts</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
    </div>

    <div class="row">
        <div class="col-md-4">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Payables</h3>
                </div>
                <div class="panel-body">
                    <table class="table table-striped table-condensed">
                        <thead>
                            <th>Counterparty</th>
                            <th style = "text-align: right;">Amount</th>
                        </thead>
                        <tbody>
                            {% for row in ap_rows %}
                                <tr>
                                    <td>{{row.0}}</td>
                                    <td align="right">
                                        <a href="{{row.2}}">{{row.1|floatformat:2|intcomma}}</a>
                                    </td>
                                </tr>    
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div> <!-- col-md-6-->

        <div class="col-md-4">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Receivables</h3>
                </div>
                <div class="panel-body">
                    <table class="table table-striped table-condensed">
                        <thead>
                            <th>Counterparty</th>
                            <th style = "text-align: right;">Amount</th>
                        </thead>
                        <tbody>
                        {% for row in ar_rows %}
                            <tr>
                                <td>{{row.0}}</td>
                                <td align="right">
                                    <a href="{{row.2}}">{{row.1|floatformat:0|intcomma}}</a>
                                </td>
                            </tr>    
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Upcoming Due Dates</h3>
                </div>
                <div class="panel-body">
                    <table class="table table-striped table-condensed">
                        <thead>
                            <th>Date</th>
                            <th>Counterparty</th>
                            <th style = "text-align: right;">Amount</th>
                        </thead>
                        <tbody>
                        
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Modal -->



<div class="modal fade" id="loadUPS" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h3 class="modal-title" id="myModalLabel">Upload UPS charges</h3>
      </div>
      <div class="modal-body">
        <p>Please choose a .csv file</p>

        <form role='form' enctype="multipart/form-data" method="post" action="/importers/ups_upload/">{% csrf_token %}
            <div class="form-group">    
                {{upload_form.as_p}}
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
            <a href='/' class="btn btn-default">Cancel</a>
        </form>

      </div>
      
    </div>
  </div>
</div>

<div class="modal fade" id="loadMasterCard" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h3 class="modal-title" id="myModalLabel">Upload Mastercard activity</h3>
      </div>
      <div class="modal-body">
        <p>Please choose a .ofx file</p>

        <form role='form' enctype="multipart/form-data" method="post" action="/base/upload/mastercard/">{% csrf_token %}
            <div class="form-group">    
                {{upload_form.as_p}}
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
            <a href='/' class="btn btn-default">Cancel</a>
        </form>

      </div>
      
    </div>
  </div>
</div>

<div class="modal fade" id="help" tabindex="-1" role="dialog" aria-labelledby="helpLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body">
        <div id="the-help"></div>
        <h3>Testing the Bootstrap React component</h3>
        <div id="the-help2"></div>
        
      </div>
    </div>
  </div>
</div>



<!-- MODAL COMPONENTS -->
<div id="bookkeeping.unpaidShopify"></div>
<div id="bookkeeping.shopifyComp"></div>
<div id="bookkeeping.fulfillNoShipcharge"></div>
<div id="bookkeeping.upsInvoices"></div>
<div id="bookkeeping.misBilledUPS"></div>

<div id="bookkeeping.upload.FRB"></div>
<div id="bookkeeping.upload.UPS"></div>


{% render_bundle 'bookkeeping' %}

{% endblock %}

{% block sidebar %}
<div class="panel panel-default">
    <div class="panel-body">
      <a class="btn btn-success btn-lg" data-toggle="modal" data-target="#help">
        <span style="font-size:2em;" class="glyphicon  glyphicon-question-sign" aria-hidden="true"></span>
      </a>
    </div>
</div>
{% endblock %}

{% block extrajs %}
<script src="{{ STATIC_URL }}base/js/bootstrap-table.js"></script>
{% endblock %}